data = [
  {
    "name": "APOCALYPTICA",
    "stage": "Mainstage 1",
    "date": "Jeudi 19 Juin",
    "time": "18:00 - 18:40",
    "genre": "METAL SYMPHONIQUE",
    "favorite": false
  },
  {
    "name": "AIRBOURNE",
    "stage": "Mainstage 1",
    "date": "Jeudi 19 Juin",
    "time": "19:30 - 20:20",
    "genre": "HARD ROCK",
    "favorite": false
  },
  {
    "name": "TILL LINDEMANN",
    "stage": "Mainstage 1",
    "date": "Jeudi 19 Juin",
    "time": "21:20 - 22:20",
    "genre": "METAL INDUSTRIEL",
    "favorite": false
  },
  {
    "name": "KORN",
    "stage": "Mainstage 1",
    "date": "Jeudi 19 Juin",
    "time": "23:30 - 01:00",
    "genre": "NU METAL",
    "favorite": false
  },
  {
    "name": "SKINDRED",
    "stage": "Mainstage 1",
    "date": "Jeudi 19 Juin",
    "time": "16:30 - 17:10",
    "genre": "RAGGA METAL",
    "favorite": false
  },
  {
    "name": "CACHEMIRE",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "11:05 - 11:35",
    "genre": "ROCK",
    "favorite": false
  },
  {
    "name": "VOWWS",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "12:15 - 12:45",
    "genre": "DEATH-POP",
    "favorite": false
  },
  {
    "name": "LAST TRAIN",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "13:35 - 14:15",
    "genre": "ROCK",
    "favorite": false
  },
  {
    "name": "THE WARNING",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "15:05 - 15:45",
    "genre": "HARD ROCK",
    "favorite": false
  },
  {
    "name": "ROYAL REPUBLIC",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "16:40 - 17:30",
    "genre": "ROCK'N ROLL",
    "favorite": false
  },
  {
    "name": "THE CULT",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "18:35 - 19:25",
    "genre": "HARD ROCK",
    "favorite": false
  },
  {
    "name": "THE HU",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "20:35 - 21:40",
    "genre": "HUNNU ROCK",
    "favorite": false
  },
  {
    "name": "MUSE",
    "stage": "Mainstage 1",
    "date": "Vendredi 20 Juin",
    "time": "23:05 - 00:35",
    "genre": "ROCK",
    "favorite": false
  },
  {
    "name": "LUCIE SUE",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "11:05 - 11:35",
    "genre": "ROCK",
    "favorite": false
  },
  {
    "name": "AUDREY HORNE",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "12:15 - 12:45",
    "genre": "HARD ROCK",
    "favorite": false
  },
  {
    "name": "THE SOUTHERN RIVER BAND",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "13:35 - 14:15",
    "genre": "HARD ROCK",
    "favorite": false
  },
  {
    "name": "D-A-D",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "15:10 - 15:55",
    "genre": "HARD ROCK"
  },
  {
    "name": "MYLES KENNEDY",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "16:50 - 17:35",
    "genre": "HARD ROCK"
  },
  {
    "name": "BLACK COUNTRY COMMUNION",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "18:30 - 19:30",
    "genre": "HARD ROCK"
  },
  {
    "name": "SATCHVAI BAND : JOE SATRIANI & STEVE VAI",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "20:35 - 21:45",
    "genre": "HARD ROCK"
  },
  {
    "name": "SCORPIONS",
    "stage": "Mainstage 1",
    "date": "Samedi 21 Juin",
    "time": "23:10 - 00:40",
    "genre": "HARD ROCK"
  },
  {
    "name": "BASTARDANE",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "11:05 - 11:35",
    "genre": "HARD ROCK"
  },
  {
    "name": "ASHEN",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "12:15 - 12:45",
    "genre": "METALCORE"
  },
  {
    "name": "BLACKGOLD",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "13:35 - 14:15",
    "genre": "NU METAL"
  },
  {
    "name": "DEAD POET SOCIETY",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "15:10 - 15:55",
    "genre": "ROCK"
  },
  {
    "name": "EAGLES OF DEATH METAL",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "16:50 - 17:40",
    "genre": "ROCK"
  },
  {
    "name": "REFUSED",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "18:40 - 19:40",
    "genre": "PUNK HARDCORE"
  },
  {
    "name": "CYPRESS HILL",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "20:50 - 21:50",
    "genre": "HIP-HOP"
  },
  {
    "name": "LINKIN PARK",
    "stage": "Mainstage 1",
    "date": "Dimanche 22 Juin",
    "time": "23:00 - 00:30",
    "genre": "NU-METAL / ROCK"
  },
  {
    "name": "SEVEN HOURS AFTER VIOLET",
    "stage": "Mainstage 2",
    "date": "Jeudi 19 Juin",
    "time": "17:15 - 17:55",
    "genre": "NU METAL"
  },
  {
    "name": "KIM DRACULA",
    "stage": "Mainstage 2",
    "date": "Jeudi 19 Juin",
    "time": "18:45 - 19:25",
    "genre": "TRAP METAL / NU METAL"
  },
  {
    "name": "IMMINENCE",
    "stage": "Mainstage 2",
    "date": "Jeudi 19 Juin",
    "time": "20:25 - 21:15",
    "genre": "METALCORE"
  },
  {
    "name": "ULTRA VOMIT",
    "stage": "Mainstage 2",
    "date": "Jeudi 19 Juin",
    "time": "22:25 - 23:25",
    "genre": "METAL PARODIQUE"
  },
  {
    "name": "ELECTRIC CALLBOY",
    "stage": "Mainstage 2",
    "date": "Jeudi 19 Juin",
    "time": "01:05 - 02:05",
    "genre": "METALCORE ELECTRONIQUE"
  },
  {
    "name": "SUN",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "10:30 - 11:00",
    "genre": "BRUTAL POP"
  },
  {
    "name": "CHARLOTTE WESSELS",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "11:40 - 12:10",
    "genre": "METAL MÉLODIQUE"
  },
  {
    "name": "AMIRA ELFEKY",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "12:50 - 13:30",
    "genre": "METAL ALTERNATIF"
  },
  {
    "name": "FUTURE PALACE",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "14:20 - 15:00",
    "genre": "POST HARDCORE"
  },
  {
    "name": "KITTIE",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "15:50 - 16:35",
    "genre": "NU METAL"
  },
  {
    "name": "SPIRITBOX",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "17:35 - 18:30",
    "genre": "METALCORE / DJENT"
  },
  {
    "name": "EPICA",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "19:30 - 20:30",
    "genre": "METAL SYMPHONIQUE"
  },
  {
    "name": "WITHIN TEMPTATION",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "21:45 - 23:00",
    "genre": "METAL SYMPHONIQUE"
  },
  {
    "name": "HEILUNG",
    "stage": "Mainstage 2",
    "date": "Vendredi 20 Juin",
    "time": "00:40 - 02:10",
    "genre": "NEO FOLK"
  },
  {
    "name": "ADX",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "10:30 - 11:00",
    "genre": "SPEED METAL"
  },
  {
    "name": "MAJESTICA",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "11:40 - 12:10",
    "genre": "POWER METAL SYMPHONIQUE"
  },
  {
    "name": "ROSS THE BOSS",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "12:50 - 13:30",
    "genre": "HEAVY METAL"
  },
  {
    "name": "FREAK KITCHEN",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "14:20 - 15:05",
    "genre": "HEAVY METAL PROGRESSIF"
  },
  {
    "name": "VISIONS OF ATLANTIS",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "16:00 - 16:45",
    "genre": "METAL SYMPHONIQUE"
  },
  {
    "name": "BEYOND THE BLACK",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "17:40 - 18:25",
    "genre": "METAL SYMPHONIQUE"
  },
  {
    "name": "SAVATAGE",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "19:35 - 20:30",
    "genre": "HEAVY METAL"
  },
  {
    "name": "JUDAS PRIEST",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "21:50 - 23:05",
    "genre": "HEAVY METAL"
  },
  {
    "name": "DREAM THEATER",
    "stage": "Mainstage 2",
    "date": "Samedi 21 Juin",
    "time": "00:45 - 02:00",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "THE CHAINSAW MOTEL",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "10:30 - 11:00",
    "genre": "NU CORE / STONER"
  },
  {
    "name": "BLOOD COMMAND",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "11:40 - 12:10",
    "genre": "DEATHPOP / PUNK"
  },
  {
    "name": "NOVELISTS",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "12:50 - 13:30",
    "genre": "METALCORE / DJENT"
  },
  {
    "name": "POPPY",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "14:20 - 15:05",
    "genre": "POP METAL"
  },
  {
    "name": "LORNA SHORE",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "16:00 - 16:45",
    "genre": "DEATHCORE"
  },
  {
    "name": "MOTIONLESS IN WHITE",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "17:45 - 18:35",
    "genre": "METALCORE"
  },
  {
    "name": "A DAY TO REMEMBER",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "19:45 - 20:45",
    "genre": "POST HARDCORE"
  },
  {
    "name": "FALLING IN REVERSE",
    "stage": "Mainstage 2",
    "date": "Dimanche 22 Juin",
    "time": "21:55 - 22:55",
    "genre": "POST-HARDCORE"
  },
  {
    "name": "TEEN MORTGAGE",
    "stage": "Warzone",
    "date": "Jeudi 19 Juin",
    "time": "17:15 - 17:55",
    "genre": "GARAGE PUNK"
  },
  {
    "name": "STREET DOGS",
    "stage": "Warzone",
    "date": "Jeudi 19 Juin",
    "time": "18:45 - 19:35",
    "genre": "PUNK ROCK"
  },
  {
    "name": "SOFT PLAY",
    "stage": "Warzone",
    "date": "Jeudi 19 Juin",
    "time": "20:45 - 21:45",
    "genre": "PUNK ROCK"
  },
  {
    "name": "THE HELLACOPTERS",
    "stage": "Warzone",
    "date": "Jeudi 19 Juin",
    "time": "22:55 - 23:55",
    "genre": "GARAGE ROCK"
  },
  {
    "name": "TURBONEGRO",
    "stage": "Warzone",
    "date": "Jeudi 19 Juin",
    "time": "01:05 - 02:05",
    "genre": "DEATH PUNK"
  },
  {
    "name": "BÉTON ARMÉ",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "11:05 - 11:35",
    "genre": "OÏ"
  },
  {
    "name": "MIKE MCCOLGAN AND THE BOMB SQUAD",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "12:15 - 12:45",
    "genre": "PUNK ROCK"
  },
  {
    "name": "FRUSTRATION",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "13:35 - 14:15",
    "genre": "POST PUNK"
  },
  {
    "name": "LION'S LAW",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "15:10 - 15:55",
    "genre": "OÏ"
  },
  {
    "name": "LEFTÖVER CRACK",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "16:50 - 17:40",
    "genre": "SKA PUNK"
  },
  {
    "name": "THE REAL MCKENZIES",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "18:40 - 19:30",
    "genre": "PUNK CELTIQUE"
  },
  {
    "name": "LES GARÇONS BOUCHERS",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "20:40 - 21:40",
    "genre": "ROCK / PUNK / JAVA"
  },
  {
    "name": "THE DAMNED",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "22:50 - 23:50",
    "genre": "PUNK"
  },
  {
    "name": "SEX PISTOLS & FRANK CARTER",
    "stage": "Warzone",
    "date": "Vendredi 20 Juin",
    "time": "01:00 - 02:10",
    "genre": "PUNK"
  },
  {
    "name": "LAST HOUNDS",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "11:05 - 11:35",
    "genre": "PUNK HARDCORE"
  },
  {
    "name": "PEST CONTROL",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "12:15 - 12:45",
    "genre": "CROSSOVER THRASH"
  },
  {
    "name": "SPY",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "13:35 - 14:15",
    "genre": "HARDCORE"
  },
  {
    "name": "THE CHISEL",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "15:10 - 15:55",
    "genre": "PUNK / OÏ"
  },
  {
    "name": "NASTY",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "16:50 - 17:40",
    "genre": "HARDCORE BEATDOWN"
  },
  {
    "name": "STICK TO YOUR GUNS",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "18:40 - 19:30",
    "genre": "HARDCORE / PUNK ROCK"
  },
  {
    "name": "TERROR",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "20:40 - 21:40",
    "genre": "HARDCORE"
  },
  {
    "name": "DEFEATER",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "22:50 - 23:50",
    "genre": "HARDCORE MELODIQUE"
  },
  {
    "name": "TURNSTILE",
    "stage": "Warzone",
    "date": "Samedi 21 Juin",
    "time": "01:00 - 02:00",
    "genre": "HARDCORE"
  },
  {
    "name": "CALCINE",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "11:05 - 11:35",
    "genre": "HARDCORE"
  },
  {
    "name": "GOUGE AWAY",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "12:15 - 12:45",
    "genre": "POST-HARDCORE / NOISE ROCK"
  },
  {
    "name": "PAIN OF TRUTH",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "13:35 - 14:15",
    "genre": "HARDCORE"
  },
  {
    "name": "GUILT TRIP",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "15:10 - 15:55",
    "genre": "HARDCORE"
  },
  {
    "name": "GORILLA BISCUITS",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "16:50 - 17:40",
    "genre": "HARDCORE"
  },
  {
    "name": "GOOD RIDDANCE",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "18:40 - 19:40",
    "genre": "PUNK HARDCORE"
  },
  {
    "name": "WALLS OF JERICHO",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "20:50 - 21:50",
    "genre": "HARDCORE"
  },
  {
    "name": "KNOCKED LOOSE",
    "stage": "Warzone",
    "date": "Dimanche 22 Juin",
    "time": "23:00 - 00:00",
    "genre": "HARDCORE"
  },
  {
    "name": "TAR POND",
    "stage": "Valley",
    "date": "Jeudi 19 Juin",
    "time": "16:30 - 17:10",
    "genre": "DOOM"
  },
  {
    "name": "SLOMOSA",
    "stage": "Valley",
    "date": "Jeudi 19 Juin",
    "time": "18:00 - 18:40",
    "genre": "STONER / DOOM"
  },
  {
    "name": "CHAT PILE",
    "stage": "Valley",
    "date": "Jeudi 19 Juin",
    "time": "19:40 - 20:40",
    "genre": "NOISE ROCK"
  },
  {
    "name": "MONKEY3",
    "stage": "Valley",
    "date": "Jeudi 19 Juin",
    "time": "21:50 - 22:50",
    "genre": "STONER PSYCHEDELIQUE"
  },
  {
    "name": "ORANGE GOBLIN",
    "stage": "Valley",
    "date": "Jeudi 19 Juin",
    "time": "00:00 - 01:00",
    "genre": "STONER"
  },
  {
    "name": "WORMSAND",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "10:30 - 11:00",
    "genre": "STONER / SLUDGE"
  },
  {
    "name": "CASTLE RAT",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "11:40 - 12:10",
    "genre": "DOOM"
  },
  {
    "name": "DIRTY SOUND MAGNET",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "12:50 - 13:30",
    "genre": "ROCK PSYCHEDELIQUE"
  },
  {
    "name": "SANDRIDER",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "14:20 - 15:05",
    "genre": "STONER"
  },
  {
    "name": "ÅRABROT \"RITE OF DIONYSUS\"",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "16:00 - 16:45",
    "genre": "NOISE"
  },
  {
    "name": "DOPETHRONE",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "17:45 - 18:35",
    "genre": "DOOM / SLUDGE"
  },
  {
    "name": "CRIPPLED BLACK PHOENIX",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "19:35 - 20:35",
    "genre": "POST-ROCK"
  },
  {
    "name": "PENTAGRAM",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "21:45 - 22:45",
    "genre": "DOOM"
  },
  {
    "name": "HERMANO",
    "stage": "Valley",
    "date": "Vendredi 20 Juin",
    "time": "23:55 - 00:55",
    "genre": "STONER"
  },
  {
    "name": "HOWARD",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "10:30 - 11:00",
    "genre": "FUZZ ROCK"
  },
  {
    "name": "THE MIDNIGHT GHOST TRAIN",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "11:40 - 12:10",
    "genre": "STONER / HARD ROCK"
  },
  {
    "name": "MARS RED SKY",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "12:50 - 13:30",
    "genre": "STONER PSYCHEDELIQUE"
  },
  {
    "name": "STONED JESUS",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "14:20 - 15:05",
    "genre": "STONER / DOOM"
  },
  {
    "name": "CONAN",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "16:00 - 16:45",
    "genre": "DOOM"
  },
  {
    "name": "MY SLEEPING KARMA",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "17:45 - 18:35",
    "genre": "ROCK PSYCHEDELIQUE INSTRUMENTAL"
  },
  {
    "name": "WINDHAND",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "19:35 - 20:35",
    "genre": "DOOM"
  },
  {
    "name": "HAVE A NICE LIFE",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "21:45 - 22:45",
    "genre": "SHOAEGAZE / POST PUNK"
  },
  {
    "name": "RUSSIAN CIRCLES",
    "stage": "Valley",
    "date": "Samedi 21 Juin",
    "time": "23:55 - 00:55",
    "genre": "POST METAL INSTRUMENTAL"
  },
  {
    "name": "BLACK BILE",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "10:30 - 11:00",
    "genre": "DOOM / POST METAL"
  },
  {
    "name": "CROWS",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "11:40 - 12:10",
    "genre": "POST PUNK"
  },
  {
    "name": "FAETOOTH",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "12:50 - 13:30",
    "genre": "FAIRY DOOM"
  },
  {
    "name": "PRAYERS",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "14:20 - 15:05",
    "genre": "CHOLO-GOTH"
  },
  {
    "name": "MESSA",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "16:00 - 16:45",
    "genre": "DOOM"
  },
  {
    "name": "KYLESA",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "17:45 - 18:35",
    "genre": "SLUDGE"
  },
  {
    "name": "HEALTH",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "19:45 - 20:45",
    "genre": "ELECTRO NOISE"
  },
  {
    "name": "JERRY CANTRELL",
    "stage": "Valley",
    "date": "Dimanche 22 Juin",
    "time": "21:55 - 22:55",
    "genre": "ROCK / GRUNGE"
  },
  {
    "name": "WALKWAYS",
    "stage": "Altar",
    "date": "Jeudi 19 Juin",
    "time": "16:30 - 17:10",
    "genre": "METAL ALTERNATIF"
  },
  {
    "name": "MENTAL CRUELTY",
    "stage": "Altar",
    "date": "Jeudi 19 Juin",
    "time": "18:00 - 18:40",
    "genre": "BLACKENED DEATHCORE"
  },
  {
    "name": "FIT FOR AN AUTOPSY",
    "stage": "Altar",
    "date": "Jeudi 19 Juin",
    "time": "19:40 - 20:40",
    "genre": "DEATHCORE"
  },
  {
    "name": "JINJER",
    "stage": "Altar",
    "date": "Jeudi 19 Juin",
    "time": "21:50 - 22:50",
    "genre": "METALCORE / DJENT"
  },
  {
    "name": "WHITECHAPEL",
    "stage": "Altar",
    "date": "Jeudi 19 Juin",
    "time": "00:00 - 01:00",
    "genre": "DEATHCORE"
  },
  {
    "name": "FURIES",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "10:30 - 11:00",
    "genre": "HEAVY METAL"
  },
  {
    "name": "HEXECUTOR",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "11:40 - 12:10",
    "genre": "THRASH METAL / SPEED METAL"
  },
  {
    "name": "THE NIGHT ETERNAL",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "12:50 - 13:30",
    "genre": "HEAVY METAL"
  },
  {
    "name": "BURNING WITCHES",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "14:20 - 15:05",
    "genre": "HEAVY METAL"
  },
  {
    "name": "NERVOSA",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "16:00 - 16:45",
    "genre": "THRASH METAL / DEATH METAL"
  },
  {
    "name": "3 INCHES OF BLOOD",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "17:45 - 18:35",
    "genre": "THRASH / SPEED METAL"
  },
  {
    "name": "TANKARD",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "19:35 - 20:35",
    "genre": "THRASH METAL"
  },
  {
    "name": "EXODUS",
    "stage": "Altar",
    "date": "Vendredi 20 Juin",
    "time": "21:45 - 22:45",
    "genre": "THRASH METAL"
  },
  {
    "name": "VESTIGE",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "10:30 - 11:00",
    "genre": "METAL PROGRESSIF / SHOEGAZE"
  },
  {
    "name": "SYK",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "11:40 - 12:10",
    "genre": "DEATH METAL PROGRESSIF"
  },
  {
    "name": "URNE",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "12:50 - 13:30",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "VULTURE INDUSTRIES",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "14:20 - 15:05",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "PERSEFONE",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "16:00 - 16:45",
    "genre": "DEATH METAL PROGRESSIF"
  },
  {
    "name": "WHEEL",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "17:45 - 18:35",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "THE OCEAN",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "19:35 - 20:35",
    "genre": "POST METAL PROGRESSIF"
  },
  {
    "name": "VOLA",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "21:45 - 22:45",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "LEPROUS",
    "stage": "Altar",
    "date": "Samedi 21 Juin",
    "time": "23:55 - 00:55",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "TSAR",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "10:30 - 11:00",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "GUINEAPIG",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "11:40 - 12:10",
    "genre": "GOREGRIND"
  },
  {
    "name": "UNE MISERE",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "12:50 - 13:30",
    "genre": "HARDCORE"
  },
  {
    "name": "SIGNS OF THE SWARM",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "14:20 - 15:05",
    "genre": "DEATHCORE"
  },
  {
    "name": "GUTALAX",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "16:00 - 16:45",
    "genre": "GRINDCORE"
  },
  {
    "name": "CATTLE DECAPITATION",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "17:45 - 18:35",
    "genre": "DEATHGRIND"
  },
  {
    "name": "UNLEASHED",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "19:45 - 20:45",
    "genre": "DEATH METAL"
  },
  {
    "name": "DETHKLOK",
    "stage": "Altar",
    "date": "Dimanche 22 Juin",
    "time": "21:55 - 22:55",
    "genre": "DEATH METAL MÉLODIQUE"
  },
  {
    "name": "MISþYRMING",
    "stage": "Temple",
    "date": "Jeudi 19 Juin",
    "time": "17:15 - 17:55",
    "genre": "BLACK METAL"
  },
  {
    "name": "THY CATAFALQUE",
    "stage": "Temple",
    "date": "Jeudi 19 Juin",
    "time": "18:45 - 19:35",
    "genre": "METAL AVANT-GARDISTE"
  },
  {
    "name": "IHSAHN",
    "stage": "Temple",
    "date": "Jeudi 19 Juin",
    "time": "20:45 - 21:45",
    "genre": "METAL PROGRESSIF"
  },
  {
    "name": "SUNN O)))",
    "stage": "Temple",
    "date": "Jeudi 19 Juin",
    "time": "22:55 - 23:55",
    "genre": "DRONE"
  },
  {
    "name": "ALCEST",
    "stage": "Temple",
    "date": "Jeudi 19 Juin",
    "time": "01:05 - 02:05",
    "genre": "BLACKGAZE"
  },
  {
    "name": "MORGARTEN",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "11:05 - 11:35",
    "genre": "BLACK METAL EPIQUE / FOLK METAL"
  },
  {
    "name": "BELORE",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "12:15 - 12:45",
    "genre": "BLACK METAL EPIQUE"
  },
  {
    "name": "SKILTRON",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "13:35 - 14:15",
    "genre": "FOLK METAL CELTIQUE"
  },
  {
    "name": "LUC ARBOGAST",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "15:10 - 15:55",
    "genre": "FOLK / MEDIEVAL ROCK"
  },
  {
    "name": "MÅNEGARM",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "16:50 - 17:40",
    "genre": "FOLK / BLACK METAL"
  },
  {
    "name": "SOWULO",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "18:40 - 19:30",
    "genre": "PAGAN / FOLK"
  },
  {
    "name": "TROLLFEST",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "20:40 - 21:40",
    "genre": "FOLK METAL"
  },
  {
    "name": "WIND ROSE",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "22:50 - 23:50",
    "genre": "FOLK / POWER METAL"
  },
  {
    "name": "IN EXTREMO",
    "stage": "Temple",
    "date": "Vendredi 20 Juin",
    "time": "01:00 - 02:00",
    "genre": "FOLK METAL"
  },
  {
    "name": "LUNAR TOMBFIELDS",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "11:05 - 11:35",
    "genre": "BLACK METAL ATMOSPHERIQUE"
  },
  {
    "name": "WITCH CLUB SATAN",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "12:15 - 12:45",
    "genre": "BLACK METAL"
  },
  {
    "name": "TRYGLAV",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "13:35 - 14:15",
    "genre": "BLACK METAL MELODIQUE"
  },
  {
    "name": "AGRICULTURE",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "15:10 - 15:55",
    "genre": "BLACKGAZE"
  },
  {
    "name": "SPECTRAL WOUND",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "16:50 - 17:40",
    "genre": "BLACK METAL"
  },
  {
    "name": "GRIMA",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "18:40 - 19:30",
    "genre": "BLACK METAL ATMOSPHERIQUE"
  },
  {
    "name": "DEAFHEAVEN",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "20:40 - 21:40",
    "genre": "BLACKGAZE"
  },
  {
    "name": "ABBATH \"DOOM OCCULTA\"",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "22:50 - 23:50",
    "genre": "BLACK METAL"
  },
  {
    "name": "BLOOD FIRE DEATH (A TRIBUTE TO BATHORY)",
    "stage": "Temple",
    "date": "Samedi 21 Juin",
    "time": "01:00 - 02:00",
    "genre": "VIKING METAL"
  },
  {
    "name": "GRAVEKVLT",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "11:05 - 11:35",
    "genre": "BLACK'N'ROLL"
  },
  {
    "name": "THE CEMETARY GIRLZ",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "12:15 - 12:45",
    "genre": "DEATHROCK"
  },
  {
    "name": "ALUK TODOLO",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "13:35 - 14:15",
    "genre": "ROCK OCCULTE"
  },
  {
    "name": "UNTO OTHERS",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "15:10 - 15:55",
    "genre": "HEAVY METAL GOTHIQUE"
  },
  {
    "name": "SHAÂRGHOT",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "16:50 - 17:40",
    "genre": "METAL INDUS / ELECTRO PUNK"
  },
  {
    "name": "PRIEST",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "18:40 - 19:40",
    "genre": "SYNTHPOP"
  },
  {
    "name": "THE KOVENANT",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "20:50 - 21:50",
    "genre": "SPACE / BLACK METAL"
  },
  {
    "name": "EISBRECHER",
    "stage": "Temple",
    "date": "Dimanche 22 Juin",
    "time": "23:00 - 00:00",
    "genre": "METAL INDUSTRIEL"
  }
]

// Test data for live shows
const testData = [
  {
    "name": "TEST BAND 1",
    "stage": "Temple",
    "date": new Date().toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' }),
    "time": (() => {
      const now = new Date();
      const start = new Date(now.getTime() - 15 * 60000); // 15 minutes ago
      const end = new Date(now.getTime() + 15 * 60000); // 15 minutes from now
      return `${start.getHours()}:${String(start.getMinutes()).padStart(2, '0')} - ${end.getHours()}:${String(end.getMinutes()).padStart(2, '0')}`;
    })(),
    "genre": "TEST METAL"
  },
  {
    "name": "TEST BAND 2", 
    "stage": "Altar",
    "date": new Date().toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' }),
    "time": (() => {
      const now = new Date();
      const start = new Date(now.getTime() - 5 * 60000); // 5 minutes ago
      const end = new Date(now.getTime() + 25 * 60000); // 25 minutes from now
      return `${start.getHours()}:${String(start.getMinutes()).padStart(2, '0')} - ${end.getHours()}:${String(end.getMinutes()).padStart(2, '0')}`;
    })(),
    "genre": "TEST ROCK"
  },
  // Concerts "starting soon"
  {
    "name": "TEST SOON 10MIN",
    "stage": "Valley",
    "date": new Date().toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' }),
    "time": (() => {
      const now = new Date();
      const start = new Date(now.getTime() + 10 * 60000); // 10 minutes from now
      const end = new Date(start.getTime() + 40 * 60000); // 40 minutes duration
      return `${start.getHours()}:${String(start.getMinutes()).padStart(2, '0')} - ${end.getHours()}:${String(end.getMinutes()).padStart(2, '0')}`;
    })(),
    "genre": "TEST SOON"
  },
  {
    "name": "TEST SOON 20MIN",
    "stage": "Mainstage 1",
    "date": new Date().toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' }),
    "time": (() => {
      const now = new Date();
      const start = new Date(now.getTime() + 20 * 60000); // 20 minutes from now
      const end = new Date(start.getTime() + 40 * 60000);
      return `${start.getHours()}:${String(start.getMinutes()).padStart(2, '0')} - ${end.getHours()}:${String(end.getMinutes()).padStart(2, '0')}`;
    })(),
    "genre": "TEST SOON"
  },
  {
    "name": "TEST SOON 45MIN",
    "stage": "Mainstage 2",
    "date": new Date().toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' }),
    "time": (() => {
      const now = new Date();
      const start = new Date(now.getTime() + 45 * 60000); // 45 minutes from now
      const end = new Date(start.getTime() + 40 * 60000);
      return `${start.getHours()}:${String(start.getMinutes()).padStart(2, '0')} - ${end.getHours()}:${String(end.getMinutes()).padStart(2, '0')}`;
    })(),
    "genre": "TEST SOON"
  }
];

// For testing purposes, add test data at the beginning
// data = [...testData, ...data];


data.forEach(band => {
  if (!('favorite' in band)) {
    band.favorite = false;
  }
});

// Generate a list of all unique genres
const genres = _.uniq(data.map(band => band.genre));

const palette = [
  "#ff3333", "#33aaff", "#33ff77", "#ffbb33", "#bb33ff", "#ff33bb", "#33ffbb", "#ffaa33", "#aaff33", "#3333ff"
];
const genre_colors = {};
genres.forEach((genre, i) => {
  genre_colors[genre] = palette[i % palette.length];
});

function displayList() {
  const list = document.getElementById('list');
  list.innerHTML = '';  // Clear existing cards
  
  // Sort data to put favorites at the top
  const sortedData = [...data].sort((a, b) => {
    if (a.favorite && !b.favorite) return -1;
    if (!a.favorite && b.favorite) return 1;
    return 0;
  });
  
  sortedData.forEach((band, index) => {
    // Trouver l'index original dans le tableau data
    const originalIndex = data.findIndex(b => b.name === band.name && b.stage === band.stage && b.date === band.date);
    
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.index = originalIndex; // Utiliser l'index original
    card.dataset.genre = band.genre;
    card.dataset.stage = band.stage;
    card.dataset.date = band.date;
    card.dataset.name = band.name;
    
    if (band.favorite) {
      card.classList.add('favorite');
    }

    // Icône SVG plus détaillé pour le crâne
    const skullSvg = `💀`;
    
    // Prepare countdown HTML for favorites
    let countdownHTML = '';
    if (band.favorite) {
      const countdown = getTimeUntilShow(band);
      countdownHTML = `<div class="countdown-timer ${countdown.className}">${countdown.text}</div>`;
    }

    // Add social media buttons HTML
    const socialButtonsHTML = `
      <div class="social-buttons">
        <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(band.name)}" target="_blank" class="social-button youtube" title="YouTube">
          <img src="yt.png" alt="YouTube" class="icon-social" />
        </a>
        <a href="https://open.spotify.com/search/${encodeURIComponent(band.name)}" target="_blank" class="social-button spotify" title="Spotify">
          <img src="sptf.png" alt="Spotify" class="icon-social" />
        </a>
      </div>
    `;

    // Structure plus compacte avec regroupement des infos date/heure
    const cardInnerHTML = `
      <div class="favorite-toggle ${band.favorite ? 'active' : ''}" data-index="${originalIndex}">
        ${skullSvg}
      </div>
      ${countdownHTML}
      <div style="font-size:1.3em;font-weight:bold;margin-bottom:4px;line-height:1.1;">${band.name}</div>
      <div style="font-size:0.95em;margin-bottom:2px;">
        <span style="font-weight:bold;">Stage:</span> ${band.stage}
      </div>
      <div style="font-size:0.95em;margin-bottom:2px;">
        <span style="font-weight:bold;">Date/Time:</span> ${band.date}, ${band.time}
      </div>
      <div style="font-size:0.95em;">
        <span style="font-weight:bold;">Genre:</span> <span style="color:${genre_colors[band.genre]};font-weight:bold;">${band.genre}</span>
      </div>
      ${socialButtonsHTML}
    `;
    
    card.innerHTML = cardInnerHTML;
    list.appendChild(card);
    
    // Add event listener to the favorite toggle
    const favoriteToggle = card.querySelector('.favorite-toggle');
    favoriteToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      const dataIndex = parseInt(e.currentTarget.dataset.index, 10);
      
      // Ajouter un effet quand on clique
      favoriteToggle.classList.add('clicked');
      setTimeout(() => {
        favoriteToggle.classList.remove('clicked');
      }, 300);
      
      toggleFavorite(dataIndex);
    });
  });
}

// Add this CSS at the beginning of the file
const style = document.createElement('style');
style.textContent = `
  .social-buttons {
    display: flex;
    justify-content: center;
    gap: 14px;
    margin-top: 14px;
    margin-bottom: 2px;
  }

  .social-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 38px;
    height: 38px;
    border-radius: 50%;
    text-decoration: none;
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 0 2px 8px #0006;
    transition: transform 0.18s cubic-bezier(.4,1.3,.6,1), box-shadow 0.18s;
    border: 1.5px solid #fff2;
    position: relative;
    overflow: hidden;
  }

  .social-button:hover {
    transform: scale(1.13) rotate(-2deg);
    background: rgba(255, 255, 255, 0.18);
    box-shadow: 0 4px 16px #900a;
    border-color: #f00;
  }

  .social-button.youtube {
    border-color: #ff0000cc;
  }

  .social-button.spotify {
    border-color: #1DB954cc;
  }

  .icon-social {
    width: 24px;
    height: 24px;
    display: block;
    filter: drop-shadow(0 1px 2px #000a);
    transition: filter 0.2s;
  }
  .social-button:hover .icon-social {
    filter: drop-shadow(0 2px 6px #900a) brightness(1.15);
  }
`;
document.head.appendChild(style);

function toggleFavorite(index) {
  data[index].favorite = !data[index].favorite;
  // Mettre à jour le DOM (optionnel, car displayList sera appelé)
  const favoriteToggle = document.querySelector(`.favorite-toggle[data-index="${index}"]`);
  if (favoriteToggle) {
    favoriteToggle.classList.toggle('active');
    const card = favoriteToggle.closest('.card');
    if (card) {
      if (data[index].favorite) {
        card.classList.add('favorite');
      } else {
        card.classList.remove('favorite');
        const countdown = card.querySelector('.countdown-timer');
        if (countdown) countdown.remove();
      }
    }
  }
  // Sauvegarder les favoris dans le localStorage
  saveFavorites();
  // Rafraîchir l'affichage
  displayList();
  // Réappliquer les filtres actifs si besoin
  const activeFilters = document.querySelector('#playing-now.active') || 
                        document.querySelector('#starting-soon.active') ||
                        document.querySelector('#show-favorites.active');
  if (activeFilters) {
    if (document.querySelector('#playing-now.active')) {
      filterPlayingNow();
    } else if (document.querySelector('#starting-soon.active')) {
      filterStartingSoon();
    } else if (document.querySelector('#show-favorites.active')) {
      filterFavorites();
    }
  } else {
    applyFilters();
  }
}

function saveFavorites() {
  // On stocke uniquement les indices des favoris
  const favoriteIndices = data
    .map((band, i) => band.favorite ? i : null)
    .filter(i => i !== null);
  localStorage.setItem('hellfestFavorites', JSON.stringify(favoriteIndices));
}

function loadFavorites() {
  const savedFavorites = localStorage.getItem('hellfestFavorites');
  if (savedFavorites) {
    // On commence par tout mettre à false
    data.forEach(band => band.favorite = false);
    // Puis on active les favoris sauvegardés
    const favoriteIndices = JSON.parse(savedFavorites);
    favoriteIndices.forEach(i => {
      if (i >= 0 && i < data.length) {
        data[i].favorite = true;
      }
    });
  }
}

function filterFavorites() {
  // Reset other filters
  resetFilters();
  
  // Toggle active class
  const showFavoritesBtn = document.getElementById('show-favorites');
  
  showFavoritesBtn.classList.toggle('active');
  
  if (!showFavoritesBtn.classList.contains('active')) {
    // If toggled off, just reset filters
    applyFilters(); // Appliquer les filtres normaux pour réafficher toutes les cartes
    return;
  }
  
  const cards = document.querySelectorAll('.card');
  
  cards.forEach(card => {
    const dataIndex = parseInt(card.dataset.index, 10);
    if (dataIndex >= 0 && dataIndex < data.length) {
      const isFavorite = data[dataIndex].favorite;
      
      if (isFavorite) {
        card.classList.remove('hidden');
      } else {
        card.classList.add('hidden');
      }
    }
  });
}

function applyFilters() {
  // Remove active class from live filter buttons
  document.getElementById('playing-now').classList.remove('active');
  document.getElementById('starting-soon').classList.remove('active');
  document.getElementById('show-favorites').classList.remove('active');
  document.getElementById('soon-options').classList.add('hidden');
  
  // Remove live filter classes from cards
  document.querySelectorAll('.card').forEach(card => {
    card.classList.remove('playing-now', 'starting-soon');
  });
  
  const genre = document.getElementById('genre').value.toLowerCase();
  const stage = document.getElementById('stage').value;
  const date = document.getElementById('date').value;
  const search = document.getElementById('search').value.toLowerCase();

  const cards = document.querySelectorAll('.card');
  
  cards.forEach(card => {
    const bandName = card.dataset.name.toLowerCase();
    const bandGenre = card.dataset.genre.toLowerCase();
    const bandStage = card.dataset.stage;
    const bandDate = card.dataset.date;

    const matchesGenre = !genre || bandGenre.includes(genre);
    const matchesStage = !stage || bandStage === stage;
    const matchesDate = !date || bandDate === date;
    const matchesSearch = !search || bandName.includes(search);

    if (matchesGenre && matchesStage && matchesDate && matchesSearch) {
      card.classList.remove('hidden');
    } else {
      card.classList.add('hidden');
    }
  });
  
  // Réappliquer le tri actif pour maintenir les favoris en haut
  if (document.getElementById('sort-alpha').classList.contains('active')) {
    applySorting('alphabetical');
  } else {
    applySorting('chronological');
  }
}

// Add start and end time fields to each band
data.forEach(band => {
  if (band.time) {
    const [start, end] = band.time.split(' - ');
    band.start = start;
    band.end = end;
  }
});

// Convert time string (HH:MM) to minutes since midnight
function timeToMinutes(timeStr) {
  const [hours, minutes] = timeStr.split(':').map(Number);
  // Handle times after midnight (e.g., 01:30 becomes 25:30 in 24hr format)
  return (hours >= 0 && hours < 6 ? hours + 24 : hours) * 60 + minutes;
}

// Check if a band is playing right now
function isPlayingNow(band, currentTime) {
  const currentDate = currentTime.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' });
  const adjustedDate = currentDate.charAt(0).toUpperCase() + currentDate.slice(1);
  
  // Different date format than what we have in the data, so we need to compare only day and month
  const [, currentDay, currentMonth] = adjustedDate.split(' ');
  const [, bandDay, bandMonth] = band.date.split(' ');
  
  if (currentDay !== bandDay || currentMonth !== bandMonth) {
    return false;
  }
  
  const currentMinutes = timeToMinutes(currentTime.getHours() + ':' + currentTime.getMinutes());
  const startMinutes = timeToMinutes(band.start);
  const endMinutes = timeToMinutes(band.end);
  
  return currentMinutes >= startMinutes && currentMinutes <= endMinutes;
}

// Check if a band is starting soon (within the next timeWindow minutes)
function isStartingSoon(band, currentTime, timeWindow = 60) {
  const currentDate = currentTime.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' });
  const adjustedDate = currentDate.charAt(0).toUpperCase() + currentDate.slice(1);
  
  // Different date format than what we have in the data, so we need to compare only day and month
  const [, currentDay, currentMonth] = adjustedDate.split(' ');
  const [, bandDay, bandMonth] = band.date.split(' ');
  
  if (currentDay !== bandDay || currentMonth !== bandMonth) {
    return false;
  }
  
  const currentMinutes = timeToMinutes(currentTime.getHours() + ':' + currentTime.getMinutes());
  const startMinutes = timeToMinutes(band.start);
  
  // Band is starting within the next timeWindow minutes and hasn't started yet
  return startMinutes > currentMinutes && startMinutes <= currentMinutes + timeWindow;
}

function displayFilter() {
  const filter = document.getElementById('filter');
  const genres = [...new Set(data.map(band => band.genre))].sort();
  const stages = [...new Set(data.map(band => band.stage))].sort();
  const dateOrder = ["Dimanche 22 Juin", "Samedi 21 Juin", "Vendredi 20 Juin", "Jeudi 19 Juin"];
  const dates = [...new Set(data.map(band => band.date))]
    .sort((a, b) => dateOrder.indexOf(a) - dateOrder.indexOf(b));

  filter.innerHTML = `
    <div class="filter-group">
      <label for="genre">Genre</label>
      <select id="genre">
        <option value="">Tous</option>
        ${genres.map(genre => `<option value="${genre}">${genre}</option>`).join('')}
      </select>
    </div>
    
    <div class="filter-group">
      <label for="stage">Scène</label>
      <select id="stage">
        <option value="">Tous</option>
        ${stages.map(stage => `<option value="${stage}">${stage}</option>`).join('')}
      </select>
    </div>
    
    <div class="filter-group">
      <label for="date">Date</label>
      <select id="date">
        <option value="">Toutes</option>
        ${dates.map(date => `<option value="${date}">${date}</option>`).join('')}
      </select>
    </div>
    
    <div class="filter-group">
      <label for="search">Groupe</label>
      <input type="text" id="search" placeholder="Henry Dès...">
    </div>
    
    <div class="live-filters">
      <div class="live-filter-group">
        <button id="playing-now" class="filter-btn">🔴 En direct</button>
        <button id="starting-soon" class="filter-btn">⏰ À venir</button>
      </div>
      <div class="soon-options hidden" id="soon-options">
        <label>
          <input type="radio" name="timeWindow" value="30" checked> 30m
        </label>
        <label>
          <input type="radio" name="timeWindow" value="60"> 1h
        </label>
        <label>
          <input type="radio" name="timeWindow" value="120"> 2h
        </label>
      </div>
    </div>
    <div class="live-filters">
      <div class="live-filter-group">
        <button id="show-favorites" class="filter-btn">💀 Favoris</button>
      </div>
    </div>
    <div class="live-filters">
      <div class="live-filter-group">
        <button id="sort-date" class="filter-btn active">🕒 Date</button>
        <button id="sort-alpha" class="filter-btn">🔤 ABC</button>
      </div>
    </div>

    
    <div class="timestamp-container">
      <div id="current-time"></div>
      <button id="refresh-time" class="refresh-btn">🔄</button>
    </div>
    
    <div class="reset-container">
      <button class="reset-btn" onclick="resetFilters()">Reset</button>
    </div>
  `;

  // Add sort event listeners
  document.getElementById('sort-date').addEventListener('click', () => {
    document.getElementById('sort-date').classList.add('active');
    document.getElementById('sort-alpha').classList.remove('active');
    applySorting('chronological');
  });
  
  document.getElementById('sort-alpha').addEventListener('click', () => {
    document.getElementById('sort-alpha').classList.add('active');
    document.getElementById('sort-date').classList.remove('active');
    applySorting('alphabetical');
  });

  // Add event listeners
  document.getElementById('genre').addEventListener('change', applyFilters);
  document.getElementById('stage').addEventListener('change', applyFilters);
  document.getElementById('date').addEventListener('change', applyFilters);
  document.getElementById('search').addEventListener('input', applyFilters);
  
  // Add live filter event listeners
  document.getElementById('playing-now').addEventListener('click', filterPlayingNow);
  document.getElementById('starting-soon').addEventListener('click', () => {
    const soonOptions = document.getElementById('soon-options');
    soonOptions.classList.toggle('hidden');
    
    // If we're showing the options, also apply the filter
    if (!soonOptions.classList.contains('hidden')) {
      filterStartingSoon();
    }
  });
  
  // Add favorites filter event listener
  document.getElementById('show-favorites').addEventListener('click', filterFavorites);
  
  // Add time window event listeners
  document.querySelectorAll('input[name="timeWindow"]').forEach(radio => {
    radio.addEventListener('change', filterStartingSoon);
  });
  
  // Add refresh button event listener
  document.getElementById('refresh-time').addEventListener('click', () => {
    updateCurrentTime();
    updateCountdowns();
    // Re-apply the active filter
    if (document.getElementById('playing-now').classList.contains('active')) {
      filterPlayingNow();
    } else if (document.getElementById('starting-soon').classList.contains('active')) {
      filterStartingSoon();
    } else if (document.getElementById('show-favorites').classList.contains('active')) {
      filterFavorites();
    }
  });
  
  // Initialize current time
  updateCurrentTime();
  
  // Auto-refresh time every second
  setInterval(() => {
    updateCountdowns();
  }, 1000); // 1000ms = 1 second
  
  // Update the current time display less frequently (every minute)
  setInterval(() => {
    updateCurrentTime();
  }, 60000); // 60000ms = 1 minute
}

function updateCurrentTime() {
  const currentTimeElem = document.getElementById('current-time');
  const now = new Date();
  const options = { 
    weekday: 'long', 
    day: 'numeric', 
    month: 'long', 
    hour: '2-digit', 
    minute: '2-digit' 
  };
  currentTimeElem.textContent = 'Heure actuelle: ' + now.toLocaleDateString('fr-FR', options);
}

function filterPlayingNow() {
  // Reset other filters
  resetFilters();
  
  // Toggle active class
  const playingNowBtn = document.getElementById('playing-now');
  const startingSoonBtn = document.getElementById('starting-soon');
  
  playingNowBtn.classList.toggle('active');
  startingSoonBtn.classList.remove('active');
  document.getElementById('soon-options').classList.add('hidden');
  
  if (!playingNowBtn.classList.contains('active')) {
    // If toggled off, just reset filters
    applyFilters(); // Réappliquer les filtres normaux
    return;
  }
  
  const now = new Date();
  const cards = document.querySelectorAll('.card');
  
  cards.forEach(card => {
    const dataIndex = parseInt(card.dataset.index, 10);
    if (dataIndex >= 0 && dataIndex < data.length) {
      const band = data[dataIndex];
      
      if (isPlayingNow(band, now)) {
        card.classList.remove('hidden');
        card.classList.add('playing-now');
      } else {
        card.classList.add('hidden');
        card.classList.remove('playing-now');
      }
    }
  });
}

function filterStartingSoon() {
  // Reset other filters
  resetFilters();
  
  // Toggle active class
  const playingNowBtn = document.getElementById('playing-now');
  const startingSoonBtn = document.getElementById('starting-soon');
  
  startingSoonBtn.classList.add('active');
  playingNowBtn.classList.remove('active');
  
  const now = new Date();
  const cards = document.querySelectorAll('.card');
  const timeWindow = parseInt(document.querySelector('input[name="timeWindow"]:checked').value, 10);
  
  cards.forEach(card => {
    const dataIndex = parseInt(card.dataset.index, 10);
    if (dataIndex >= 0 && dataIndex < data.length) {
      const band = data[dataIndex];
      
      if (isStartingSoon(band, now, timeWindow)) {
      card.classList.remove('hidden');
        card.classList.add('starting-soon');
    } else {
      card.classList.add('hidden');
        card.classList.remove('starting-soon');
      }
    }
  });
}

function applySorting(sortType) {
  const list = document.getElementById('list');
  const cards = Array.from(list.children);

  cards.sort((a, b) => {
    // D'abord trier par favoris
    const aIsFavorite = a.classList.contains('favorite');
    const bIsFavorite = b.classList.contains('favorite');
    
    if (aIsFavorite && !bIsFavorite) return -1;
    if (!aIsFavorite && bIsFavorite) return 1;
    
    // Ensuite appliquer le tri spécifié
    if (sortType === 'alphabetical') {
      const nameA = a.querySelector('div:nth-child(2)').textContent.toLowerCase();
      const nameB = b.querySelector('div:nth-child(2)').textContent.toLowerCase();
      return nameA.localeCompare(nameB);
    } else { // chronological
      const dateA = a.querySelectorAll('div')[3].textContent.split(':')[1].trim();
      const dateB = b.querySelectorAll('div')[3].textContent.split(':')[1].trim();
      const timeA = a.querySelectorAll('div')[4].textContent.split(':')[1].trim().split(' - ')[0];
      const timeB = b.querySelectorAll('div')[4].textContent.split(':')[1].trim().split(' - ')[0];
      
      const dateCompare = dateA.localeCompare(dateB);
      if (dateCompare !== 0) return dateCompare;
      return timeA.localeCompare(timeB);
    }
  });

  cards.forEach(card => list.appendChild(card));
}

function resetFilters() {
  document.getElementById('genre').value = '';
  document.getElementById('stage').value = '';
  document.getElementById('date').value = '';
  document.getElementById('search').value = '';
  
  // Remove active class from live filter buttons
  document.getElementById('playing-now').classList.remove('active');
  document.getElementById('starting-soon').classList.remove('active');
  document.getElementById('show-favorites').classList.remove('active');
  document.getElementById('soon-options').classList.add('hidden');
  
  // Remove live filter classes from cards
  document.querySelectorAll('.card').forEach(card => {
    card.classList.remove('playing-now', 'starting-soon', 'hidden');
  });
  
  // Réappliquer le tri actif
  if (document.getElementById('sort-alpha').classList.contains('active')) {
    applySorting('alphabetical');
  } else {
    applySorting('chronological');
  }
}

// Add this function to calculate time until band starts playing
function getTimeUntilShow(band) {
  const now = new Date();
  // Convert date strings to actual date objects
  const currentDate = now.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' });
  const adjustedCurrentDate = currentDate.charAt(0).toUpperCase() + currentDate.slice(1);
  
  // Extract day and month from both dates
  const [, currentDay, currentMonth] = adjustedCurrentDate.split(' ');
  const [, bandDay, bandMonth] = band.date.split(' ');
  
  // Get show time in minutes
  const [bandHours, bandMinutes] = band.start.split(':').map(Number);
  
  // Create date objects for comparison
  // We need to determine if the show is today, in the future, or already past
  const monthMap = {
    'janvier': 0, 'février': 1, 'mars': 2, 'avril': 3,
    'mai': 4, 'juin': 5, 'juillet': 6, 'août': 7,
    'septembre': 8, 'octobre': 9, 'novembre': 10, 'décembre': 11
  };
  
  // Create event date - note: we're using 2024 as a placeholder year since it's not in our data
  const eventDate = new Date(2024, monthMap[bandMonth.toLowerCase()], parseInt(bandDay), bandHours, bandMinutes);
  
  // If the band is playing in the early morning hours (after midnight), adjust the date
  if (bandHours >= 0 && bandHours < 6) {
    eventDate.setDate(eventDate.getDate() + 1);
  }
  
  // Create current date with same year for comparison
  const compareDate = new Date(
    2024, 
    monthMap[currentMonth.toLowerCase()], 
    parseInt(currentDay), 
    now.getHours(), 
    now.getMinutes(), 
    now.getSeconds()
  );
  
  // Calculate difference in milliseconds
  const diffMs = eventDate - compareDate;
  
  // If the show has already passed or is now playing
  if (diffMs <= 0) {
    // Check if it's currently playing
    if (isPlayingNow({ date: band.date, start: band.start, end: band.end }, now)) {
      return { text: "🔥 EN DIRECT 🔥", className: "countdown-live" };
    } else {
      return { text: "CONCERT TERMINÉ", className: "countdown-past" };
    }
  }
  
  // Convert to readable format
  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
  const diffHours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
  const diffSeconds = Math.floor((diffMs % (1000 * 60)) / 1000);
  
  // Format the seconds with a span for styling
  const secondsFormatted = `<span class="seconds">${diffSeconds}S</span>`;
  
  // Format the output based on how much time is left
  let text = "";
  let className = "countdown-future";
  
  if (diffDays > 0) {
    text = `DANS ${diffDays}J ${diffHours}H ${diffMinutes}M ${secondsFormatted}`;
  } else if (diffHours > 0) {
    text = `DANS ${diffHours}H ${diffMinutes}M ${secondsFormatted}`;
    if (diffHours < 3) {
      className = "countdown-soon";
    }
  } else if (diffMinutes > 0) {
    text = `DANS ${diffMinutes}M ${secondsFormatted}`;
    className = diffMinutes < 30 ? "countdown-imminent" : "countdown-soon";
  } else {
    text = `DANS ${secondsFormatted}`;
    className = "countdown-imminent";
  }
  
  return { text, className, html: true };  // Add html flag to indicate HTML content
}

// Update the updateCountdowns function to handle HTML content
function updateCountdowns() {
  // Appliquer l'effet visuel "starting soon" à toutes les cartes concernées
  const now = new Date();
  const timeWindow = 60; // Par défaut, 60 minutes (ou récupère la valeur du filtre si besoin)
  const cards = document.querySelectorAll('.card');
  cards.forEach(card => {
    const dataIndex = parseInt(card.dataset.index, 10);
    if (dataIndex >= 0 && dataIndex < data.length) {
      const band = data[dataIndex];
      // On considère "starting soon" si le concert commence dans la fenêtre (par défaut 60min)
      if (isStartingSoon(band, now, timeWindow)) {
        card.classList.add('starting-soon');
      } else {
        card.classList.remove('starting-soon');
      }
    }
  });

  // Mise à jour des compteurs sur les favoris (comme avant)
  const countdownTimers = document.querySelectorAll('.countdown-timer');
  if (countdownTimers.length > 0) {
    countdownTimers.forEach(timer => {
      const card = timer.closest('.card');
      if (card) {
        const dataIndex = parseInt(card.dataset.index, 10);
        if (dataIndex >= 0 && dataIndex < data.length) {
          const band = data[dataIndex];
          const countdown = getTimeUntilShow(band);
          if (countdown.html) {
            timer.innerHTML = countdown.text;
          } else {
            timer.textContent = countdown.text;
          }
          timer.classList.remove('countdown-future', 'countdown-soon', 'countdown-imminent', 'countdown-live', 'countdown-past');
          timer.classList.add(countdown.className);
          // Ajout dynamique de la classe .starting-soon sur la carte (pour les favoris)
          if (countdown.className === 'countdown-soon' || countdown.className === 'countdown-imminent') {
            card.classList.add('starting-soon');
          }
          // Effet flicker sur le compte à rebours imminent
          if (countdown.className === 'countdown-imminent') {
            timer.classList.add('flicker');
            setTimeout(() => {
              timer.classList.remove('flicker');
            }, 100);
          }
        }
      }
    });
  }
}

// Initialize the display
loadFavorites();
displayList();
displayFilter();